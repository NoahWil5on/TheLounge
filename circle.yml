machine:
  node:
    version: 7.4.0
dependencies:
  cache_directories:
    - /opt/circleci/nodejs/v7.4.0/bin
    - /opt/circleci/nodejs/v7.4.0/lib/node_modules
  pre:
    - sudo apt-get install python-dev
    - pip install awsebcli
    - sh ./scripts/global_modules.sh
  override:
    - npm install
  post:
    - npm run build
# EB Deploy with CircleCI directions:
# https://gist.github.com/RobertoSchneiders/9e0e73e836a80d53a21e
deployment:
  production:
    branch: master
    commands:
      - sh ./scripts/deploy.sh
      - eb deploy --profile default --staged
